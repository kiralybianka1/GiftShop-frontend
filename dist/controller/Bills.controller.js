sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","Project/Project/model/invoicePriceFormatter","sap/m/MessageBox"],function(e,t,l,i){"use strict";return e.extend("Project.Project.controller.Bills",{formatter:l,onInit:function(){this.oOrderInvoiceModel=new t;this.oOrderInvoiceModel.loadData("http://localhost:8080/GiftShop/api/orderinvoices","",false);this.oSellerInvoiceModel=new t;this.oSellerInvoiceModel.loadData("http://localhost:8080/GiftShop/api/sellerinvoices","",false);this.oSellerModel=new t;this.oSellerModel.loadData("http://localhost:8080/GiftShop/api/sellers","",false);this.sellers=JSON.parse(this.oSellerModel.getJSON());this.getView().byId("sellerSelect").setModel(this.oSellerModel);this.getView().setModel(this.oOrderInvoiceModel,"orderI");this.getView().setModel(this.oSellerInvoiceModel,"acI");this.getView().byId("panel").getToolbar().getContent()[4].setVisible(false);this.getView().byId("panel").getToolbar().getContent()[5].setVisible(false);this.getView().byId("invoiceDate").setDateValue(new Date)},handleIconTabBarSelect:function(e){this.getView().byId("footer").setVisible(e.getParameter("key")==="add")},onItemPress:function(e){var t=e.getSource().getProperties();for(var l=0;l<t.length;l++){var i=t[l].getVisible();t[l].setVisible(!i)}},checkSellerInvoiceData:function(){var e=this.getView().getModel("i18n").getResourceBundle();if(this.getView().byId("sellerSelect").getSelectedItem()===null){i.error(e.getText("SellerInvoiceAddErrorMessage_EmptySeller"));return false}var t=this.getView().byId("totalPrice").getValue();if(t===""||Number.isNaN(t)){i.error(e.getText("SellerInvoiceAddErrorMessage_EmptyPrice"));return false}if(Number(t)<1||Number(t)>1e8){i.error(e.getText("SellerInvoiceAddErrorMessage_Price"));return false}return true},onAddButtonPress:function(){if(this.checkSellerInvoiceData()){this.create()}},create:function(){var e=this.getView().getModel("i18n").getResourceBundle();var t=null;for(var l=0;l<this.sellers.length;l++){if(parseInt(this.sellers[l].id,10)===parseInt(this.getView().byId("sellerSelect").getSelectedKey(),10)){t=this.sellers[l]}}var o={seller:t,invoiceDate:this.getView().byId("invoiceDate").getValue().replace(/\. /g,"-").replace(/\./g,""),totalPrice:this.getView().byId("totalPrice").getValue()};jQuery.ajax({type:"POST",contentType:"application/json",url:"http://localhost:8080/GiftShop/api/sellerinvoices",dataType:"json",data:JSON.stringify(o)});i.success(e.getText("SellerInvoiceAddSuccess"),{onClose:function(e){window.location.reload()}})}})});